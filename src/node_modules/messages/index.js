import forEach from 'lodash/forEach'
import isString from 'lodash/isString'
import frLocaleData from 'react-intl/locale-data/fr'
import React, {
  Component,
  PropTypes
} from 'react'
import {
  connect
} from 'react-redux'
import {
  addLocaleData,
  FormattedMessage,
  IntlProvider as IntlProvider_
} from 'react-intl'

// ===================================================================

const messages = {
  // ----- Titles -----
  aboutPage: {
    defaultMessage: 'About'
  },
  homePage: {
    defaultMessage: 'Home'
  },

  // ----- Sign in -----
  usernameLabel: {
    defaultMessage: 'Username:'
  },
  passwordLabel: {
    defaultMessage: 'Password:'
  },
  signInButton: {
    defaultMessage: 'Sign in'
  },

  // ----- VM actions ------
  startVmLabel: {
    defaultMessage: 'Start VM'
  },
  recoveryModeLabel: {
    defaultMessage: 'Start VM in recovery mode'
  },
  suspendVmLabel: {
    defaultMessage: 'Suspend VM'
  },
  stopVmLabel: {
    defaultMessage: 'Stop VM'
  },
  forceShutdownVmLabel: {
    defaultMessage: 'Force shutdown VM'
  },
  rebootVmLabel: {
    defaultMessage: 'Reboot VM'
  },
  forceRebootVmLabel: {
    defaultMessage: 'Force reboot VM'
  },
  deleteVmLabel: {
    defaultMessage: 'Delete VM'
  },
  migrateVmLabel: {
    defaultMessage: 'Migrate VM'
  },
  snapshotVmLabel: {
    defaultMessage: 'Snapshot VM'
  },
  exportVmLabel: {
    defaultMessage: 'Export VM'
  },
  copyVmLabel: {
    defaultMessage: 'Copy VM'
  },
  cloneVmLabel: {
    defaultMessage: 'Clone VM'
  },
  convertToTemplateLabel: {
    defaultMessage: 'Convert VM to template'
  },
  vmConsoleLabel: {
    defaultMessage: 'VM console'
  },

  // ----- VM tabs -----
  generalTabName: {
    defaultMessage: 'General'
  },
  statsTabName: {
    defaultMessage: 'Stats'
  },
  consoleTabName: {
    defaultMessage: 'Console'
  },
  snapshotsTabName: {
    defaultMessage: 'Snapshots'
  },
  logsTabName: {
    defaultMessage: 'Logs'
  },
  advancedTabName: {
    defaultMessage: 'Advanced'
  },
  networkTabName: {
    defaultMessage: 'Network'
  },
  disksTabName: {
    defaultMessage: 'Disk{disks, plural, one {} other {s}}'
  },

  powerStateHalted: {
    defaultMessage: 'halted'
  },
  powerStateRunning: {
    defaultMessage: 'running'
  },

  // ----- VM advanced tabs -----
  virtualizationMode: {
    defaultMessage: 'Virtualization mode'
  },
  xenToolsStatus: {
    defaultMessage: 'Xen tools status'
  },
  osName: {
    defaultMessage: 'OS name'
  },
  osKernel: {
    defaultMessage: 'OS kernel'
  },
  autoPowerOn: {
    defaultMessage: 'Auto power on'
  },
  ha: {
    defaultMessage: 'HA'
  },
  originalTemplate: {
    defaultMessage: 'Original template'
  }
}
forEach(messages, (message, id) => {
  if (isString(message)) {
    messages[id] = {
      id,
      defaultMessage: message
    }
  } else if (!message.id) {
    message.id = id
  }
})
const localizedMessages = {}

addLocaleData(frLocaleData)
localizedMessages.fr = {
  aboutPage: 'À propos',
  homePage: 'Accueil',
  usernameLabel: 'Nom :',
  passwordLabel: 'Mot de passe :',
  signInButton: 'Connexion',
  startVmLabel: 'Démarrer la VM',
  recoveryModeLabel: 'Démarrer la VM en mode sans échec',
  suspendVmLabel: 'Suspendre la VM',
  stopVmLabel: 'Arrêter la VM',
  forceShutdownVmLabel: 'Forcer l\'arrêt de la VM',
  rebootVmLabel: 'Redémarrer la VM',
  forceRebootVmLabel: 'Forcer le redémarrage de la VM',
  deleteVmLabel: 'Supprimer la VM',
  migrateVmLabel: 'Migrer la VM',
  snapshotVmLabel: 'Prendre un instantané de la VM',
  exportVmLabel: 'Exporter la VM',
  copyVmLabel: 'Copier la VM',
  cloneVmLabel: 'Cloner la VM',
  convertToTemplateLabel: 'Convertir la VM en modèle',
  vmConsoleLabel: 'Console de la VM',
  generalTabName: 'Général',
  statsTabName: 'Stats',
  consoleTabName: 'Console',
  snapshotsTabName: 'Snapshots',
  logsTabName: 'Journaux',
  advancedTabName: 'Avancé',
  networkTabName: 'Réseau',
  disksTabName: 'Disque{disks, plural, one {} other {s}}',
  powerStateHalted: 'arrêtée',
  powerStateRunning: 'en marche',
  virtualizationMode: 'Mode de virtualisation',
  xenToolsStatus: 'Mode de virtualisation',
  osName: 'Nom du système d\'exploitation',
  osKernel: 'Noyau du système d\'exploitation',
  autoPowerOn: 'Démarrage automatique',
  ha: 'Haute disponibilité',
  originalTemplate: 'Modèle d\'origine'
}

// ===================================================================

export default (messageId, values = {}) => <FormattedMessage
  {...messages[messageId]}
  values={values}
/>

@connect(({ lang }) => ({ lang }))
export class IntlProvider extends Component {
  static propTypes = {
    children: PropTypes.node.isRequired,
    lang: PropTypes.string.isRequired
  };

  render () {
    const { lang, children } = this.props
    return <IntlProvider_
      locale={lang}
      messages={localizedMessages[lang]}
    >
     {children}
    </IntlProvider_>
  }
}
