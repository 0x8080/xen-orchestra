import _ from 'messages'
import map from 'lodash/map'
import React from 'react'
import Icon from 'icon'

import Button from 'react-bootstrap/lib/Button'
import ButtonGroup from 'react-bootstrap/lib/ButtonGroup'
import DropdownButton from 'react-bootstrap/lib/DropdownButton'
import MenuItem from 'react-bootstrap/lib/MenuItem'

const ActionBar = ({ actions, display = 'both' }) => (
  <ButtonGroup>
    {map(actions, (action, index) =>
      !action.items
      ? <Button bsStyle='secondary' action={action.handler} key={index}>
        <Content display={display} label={action.label} icon={action.icon} />
      </Button>
      : <DropdownButton key={index}>
        {map(action.items, ({label, icon, handler}, index) => (
          <MenuItem key={index}>
            <Content display={display} label={label} icon={icon} />
          </MenuItem>
        ))}
      </DropdownButton>
    )}
  </ButtonGroup>
)
ActionBar.propTypes = {
  actions: React.PropTypes.arrayOf(
    React.PropTypes.shape({
      label: React.PropTypes.string.isRequired,
      icon: React.PropTypes.string.isRequired,
      handler: React.PropTypes.func
    })
  ).isRequired,
  display: React.PropTypes.oneOf(['icon', 'text', 'both'])
}
export default ActionBar

const Content = ({display, icon, label}) => (
  <span>
    {icon && (display === 'icon' || display === 'both') ? <Icon icon={icon} /> : null}
    {label && (display === 'text' || display === 'both') ? [' ', _(label)] : null}
  </span>
)

// actions:
// [
//   {label: 'Action1', icon: 'Icon1', handler: 'MyAction1'},
//   {
//     icon: 'MainIcon',
//     label: 'MainLabel',
//     items: [
//       {icon: 'Icon2', label: 'Action2', handler: 'MyAction2'},
//       {icon: 'Icon3', label: 'Action3', handler: 'MyAction3'}
//     ]
//   }
// ]
