#!/usr/bin/env sh

set -e -u

cd "${1:-$(dirname "$(which "$0")")}"

{
  printf %s '//
// This file has been generated by ./.generate-index.sh
//
// It MUST be re-generated each time an API namespace (read file) is
// added or removed.
//

const defaults = {}
export default defaults

'

  for f in *.js *.coffee */
  do
    [ -f "$f" ] || continue

    base=${f%.*}
    [ "$base" != index ] || continue

    printf '%s; %s\n%s\n' \
      "import $base from './$base'" \
      "defaults['$base'] = $base" \
      "export * as $base from './$base'"
  done | sort
} > index.js
